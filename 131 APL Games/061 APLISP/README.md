code is from Smillie see https://dl.acm.org/doi/pdf/10.1145/1115910.1115913
